_jsload_('AMap.TruckDriving', 'g.aaa=g.aa.extend({ja:[g.sa],r:function(a){this.CLASS_NAME="AMap.TruckDriving";g.a.ub(this);g.c.va(this,a);this.M=g.extend({showTraffic:!0,showDir:!0,policy:0,outlineColor:"#ffe",isOutline:!0,autoFitView:!0},a);this.url=g.A.Rd+"/v4/direction/truck";this.yg=[];(this.M.map||this.M.panel)&&g.qb.load("AMap.TruckDrivingRender")},gY:function(){return Math.round(1E5*Math.random())},clear:function(){g.c.add(this,"clear");this.N&&this.N.clear()},search:function(a,b){g.c.add(this,"search");var c=arguments; if(a&&0<a.length)if(a[0].lnglat)this.dk.apply(this,c);else{var d=this;g.qb.Lg(["AMap.PlaceSearch","AMap.GetLL"],function(){d.Bh||(d.Bh=new g.Tz);d.Bh.get(a,"",function(a,c){if("error"===a)b&&"function"===typeof b&&b("error",c);else if("complete"===a){for(var h=[],k=0;k<c.length;k+=1)h.push({lnglat:0==k?c[k].exit_location||c[k].location:c[k].entr_location||c[k].location,pid:c[k].id,type:c[k].type});d.dk(h,b,c)}else"no_poi"===a?b&&b("error",{info:"\\u5728\\u57ce\\u5e02"+c.city+"\\u65e0\\u6cd5\\u627e\\u5230"+ c.keyword}):"no_city"===a&&b&&b("error",{info:"\\u8bf7\\u8bbe\\u7f6e"+c.keyword+"\\u7684\\u57ce\\u5e02\\u4fe1\\u606f"})})})}},setProvinceAndNumber:function(a,b){a&&b&&(this.M.province=a,this.M.number=b)},dk:function(a,b,c){if(this.M.size){for(var d=0;d<a.length;d+=1)a[d].lnglat=g.a.Ha(a[d].lnglat);var e=["origin="+a[0].lnglat,"originid="+a[0].pid||"","originidtype="+a[0].type||"","destination="+a[a.length-1].lnglat,"destinationid="+a[a.length-1].pid||"","destinationtype="+a[a.length-1].type||"","s=rsv3"]; this.M.province&&this.M.number&&(e.push("province="+this.M.province),e.push("number="+this.M.number.toUpperCase()));e.push("strategy="+this.fa(this.M.policy));if(2<a.length){for(var f=[],d=1;d<a.length-1;d+=1)f.push(a[d].lnglat);e.push("waypoints="+f.join(";"))}e.push("key="+g.A.key);e.push("size="+this.M.size);e.push("width="+(this.M.width||2.5));e.push("height="+(this.M.height||1.6));e.push("load="+(this.M.load||0.9));e.push("weight="+(this.M.weight||10));e.push("axis="+(this.M.axlesNum||2));d= new g.fb.vb(this.url+(0<e.length?"?"+e.join("&"):""),{callback:"callback"});d.g("complete",function(d){this.Fc(d,b,c,a)},this);d.g("error",function(a){this.ec(a,b)},this)}else b&&"function"===typeof b&&b("error",{info:"NO_PARAMS",message:"No param: size."})},setPolicy:function(a){g.c.add(this,"setPolicy");this.M.policy=a},ec:function(a,b){z.event.O(this,"error",a);b&&"function"===typeof b&&b("error",a.info)},Bd:function(a){a=a.split(",");return new g.T(a[0],a[1])},hp:function(a){var b=[];a=a.split(";"); for(var c=0;c<a.length;c+=1)b[c]=this.Bd(a[c]);return b},fa:function(a){return"object"===typeof a||"undefined"===typeof a?"":a},Jb:function(a){a=parseInt(a,10);return isNaN(a)?0:a},UN:function(a){var b=[];a=a.path?[a.path]:a;for(var c=0;c<a.length;c+=1){var d=a[c];b[c]={steps:this.Gt(d.steps),restriction:this.Jb(d.restriction),distance:this.Jb(d.distance),time:this.Jb(d.duration),policy:d.strategy,tolls:this.Jb(d.tolls),tolls_distance:this.Jb(d.toll_distance)}}return b},Gt:function(a){for(var b=[], c=this,d=0;d<a.length;d+=1){var e=a[d],f=this.hp(e.polyline);b[d]={start_location:f[0],end_location:f[f.length-1],instruction:this.fa(e.instruction),orientation:this.fa(e.orientation),road:this.fa(e.road),distance:this.Jb(e.distance),tolls:this.Jb(e.tolls),toll_distance:this.Jb(e.toll_distance),toll_road:this.fa(e.toll_road),time:this.Jb(e.duration),path:f,action:this.fa(e.action),assistant_action:this.fa(e.assistant_action)};this.be(e.cities)&&(b[d].cities=this.Ft(e.cities,function(a,b){var d;switch(b){case "districts":d= c.Ft(a);break;default:d=a}return d}));this.be(e.tmcs)&&(b[d].tmcs=this.Ft(e.tmcs,function(a,b,c){switch(b){case "distance":a=+a;break;case "polyline":c.path=this.hp(a);break}return a}),b[d].tmcsPaths=this.tN(b[d].tmcs))}return b},tN:function(a){var b=[],c=null,d,e;d=0;for(e=a.length;d<e;d++){var f=a[d].path,h=a[d].status;if(!f||!f.length)return;c&&h===c.status&&f[0].cb(c.path[c.path.length-1])?c.path.push.apply(c.path,f):(b.push({path:[].concat(f),status:h}),c=b[b.length-1])}return b},Ft:function(a, b){for(var c=[],d=0;d<a.length;d+=1){var e={},f;for(f in a[d])a[d].hasOwnProperty(f)&&(e[f]="function"===typeof b?b.call(this,a[d][f],f,e):a[d][f]);c.push(e)}return c.length?c:null},be:function(a){return"[object Array]"===Object.prototype.toString.call(a)?!0:!1},close:function(){g.c.add(this,"close");this.closed=!0},open:function(){g.c.add(this,"open");this.closed=!1},Fc:function(a,b,c,d){if(!this.closed){var e,f=this;if(0!==parseInt(a.errcode,10))e={info:a.info},g.event.O(this,"error",e),b&&"function"=== typeof b&&b("error",a.info);else if(a.data&&a.data.count){e={info:a.errmsg,origin:this.Bd(a.data.route.origin),destination:this.Bd(a.data.route.destination),routes:this.UN(a.data.route.paths)};if(c)for(e.start=c[0],e.end=c[c.length-1],e.originName=e.start.name,e.destinationName=e.end.name,e.waypoints=c.slice(1,c.length-1),a=0,c=e.waypoints.length;a<c;a++)e.waypoints[a].isWaypoint=!0;else if(d&&(e.start={location:e.origin,name:"\\u8d77\\u70b9"},e.end={location:e.destination,name:"\\u7ec8\\u70b9"},e.start.type= "start",e.end.type="end",e.waypoints=[],d&&2<d.length))for(d=d.slice(1,d.length-1),a=0,c=d.length;a<c;a++)e.waypoints.push({isWaypoint:!0,location:d[a].lnglat,name:"\\u9014\\u7ecf\\u70b9",type:"waypoint"});(f.M.map||f.M.panel)&&g.qb.load("AMap.TruckDrivingRender",function(){f.N||(f.N=new window.AMap.TruckDrivingRender({showTraffic:f.M.showTraffic,showDir:f.M.showDir,zIndex:f.M.zIndex}));f.N.autoRender({data:e,panel:f.M.panel,map:f.M.map,hideMarkers:f.M.hideMarkers||!1,isOutline:f.M.isOutline,outlineColor:f.M.outlineColor, autoFitView:f.M.autoFitView},f)});g.event.O(this,"complete",e);b&&"function"===typeof b&&b("complete",e)}else e={info:"ok"===a.errmsg.toLowerCase()?"NO_DATA":a.info},g.event.O(this,"complete",e),b&&"function"===typeof b&&b("no_data",{})}}});window.AMap.TruckDriving=g.aaa; ')