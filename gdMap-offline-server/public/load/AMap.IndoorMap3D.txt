_jsload_('AMap.IndoorMap3D', 'z.o.dt=z.o.Mq.extend(g.extend({},z.o.VK,{B:{visible:!0,opacity:1,zIndex:11,featureszIndex:null,zooms:[17,20],hideFloorBar:!1,bubble:"true",rejectMapMask:!1,alwaysShow:!1,disableIconRender:!1,disableLabelRender:!1,disableHoverMarker:!1,autoLoadBuildingsInTile:!0},Eo:[215440491,106744817],setOpacity:function(a){this.get("opacity")!==a&&(z.o.dt.Sc.setOpacity.call(this,a),this.Un())},r:function(a){if(!g.l.Ok)return null;this.XA=g.a.$C(this.XA,150,this);this.LAYER_NAME="IndoorLayer3D";z.o.dt.Sc.r.call(this, a);this.fO=!g.l.Z;this.CLASS_NAME="AMap.IndoorMap";g.c.va(this,a);this.If=new z.w.rb({innerOverlay:!0,offset:new g.H(0,0),content:" ",noSelect:!0,visible:!1,cursor:a.cursor,bubble:!0});this.If.za=!0;this.oa=this.CA();this.Tc=null;this.Bb=new g.ME(this.oa);this.Bb.g("loaded",this.Un,this);this.Bb.g("featureStyleUpdate",this.sZ,this);this.Bb.g("featureLabelStyleUpdate",this.qZ,this);this.Bb.g("featureOptionsUpdate",this.rZ,this);this.uW=1;this.Ni=void 0;this.zh=g.NE;this.zh.oI({strokeColor:"rgba(224,180,135,1)", fillColor:"rgba(224,180,135,0.5)"});this.W1=[0.6705,0.6705,0.6705,1];this.tt=!0;this.xX=29;this.W_={fillColor:[0.8862745098039215,0.7803921568627451,0.7215686274509804,1],strokeColor:[0.8313725490196079,0.6862745098039216,0.5450980392156862,1]};this.Jn={fK:null,DD:null,UI:null,index:-1,rn:null,fillColor:null,strokeColor:null};this.oa&&this.mapChanged();this.SO=this.getRenderLabels;g.a.ub(this)},hG:function(a){z.o.VK.hG.call(this);this.oa.C=!0;if(this.oa&&17<=this.oa.getZoom()){var b=this.oa.getObject3DByContainerPos(a.tb|| a.pixel,[this]);if(b){var c=b.object;c&&c.ZM&&(b=this.R2(c,b.index))&&(this.q("click",this.Jha(a,b.E6)),g.l.Z&&this.Pt({id:b.$n}))}}this.oa.C=!1},Jha:function(a,b){return{type:"click",building_id:b.$n,floor:b.HF,lnglat:a.lnglat,shop:"shops"!==b.ql?null:{building_id:b.$n,category:"shop",id:b.cpid,lnglat:a.lnglat,name:b.name||b.name_cn,poiId:b.qs}}},Un:function(){var a=this;if(this.tH()){this.gB();var b=this.Rw(),c=g.a.Rb,d=g.a.keys;b.mr.length&&(c(b.mr,function(b){var f=a.Cl===b.id;c(d(b.ha),function(d){if(b.ha[d]){var k= parseInt(d)===b.Nc,l=b.ha[d].Nl;l&&(k?(l.ma.$n=b.id,a.hW(l,!0),f?a.Jaa(l):a.x_(l)):(a.x_(l),a.w_(l)));d=b.ha[d].ha;d.length&&!d[0].ma.$n&&c(d,function(c){c.ma.$n=b.id;"point"===c.Ri&&a.Dia(c)});k?a.hW(d):a.w_(d)}})}),this.VG(b.mr),this.eA(),this.K_())}},w0:function(a,b){g.a.Rb(a,function(a){for(var d=a.da,e=0,f=d.Wa.length;e<f;e+=4){var h=[e,4].concat(b);d.Wa.splice.apply(d.Wa,h)}a.At=!0});this.reDraw()},Jaa:function(a){if((a=a.Zg)&&a.zk&&!a.zk.pR){var b=g.a.uv("rgba(226,131,0,1)");this.w0(a.zk,b); a.zk.pR=!0}},x_:function(a){(a=a.Zg)&&a.zk&&a.zk.pR&&(this.w0(a.zk,this.W1),a.zk.pR=!1)},nda:function(a){function b(a){g.a.Rb(a,function(a,b){d[b]=[];g.a.Rb(a.wa,function(a){d[b].push(new g.H(a[0]-c.Eo[0],a[1]-c.Eo[1]))})})}var c=this,d=[];"multipolygon"===a.da.Ri?g.a.Rb(a.da.Nf,function(a){b(a.zf)}):b(a.da.zf);return d},w_:function(a){var b=this;a.Zg&&(a=a.Zg,a.lp&&this.remove(a.lp),a.zk&&g.a.Rb(a.zk,function(a){b.remove(a)}),this.remove(a))},hW:function(a){function b(a){h.Kd.SD(a,n.zoom+h.Kd.Vn, {Os:"polygon"});if(!a.style||!a.style.fillColor||!/rgba\\(([^)]+)\\)/.test(a.style.fillColor)||/^(?:point|polygon|multipolygon)$/.test(a.Ri))return!1;var b=h.nda(a);f(b,function(a){k.push(a)});l.push(e.uv(a.style.fillColor));m.push(e.uv(a.style.strokeColor));return!0}var c=this,d=1<arguments.length&&void 0!==arguments[1]?arguments[1]:!1,e=g.a,f=e.Rb,h=this;if(a.Zg)this.add(a.Zg),a.Zg.lp&&this.add(a.Zg.lp),a.Zg.zk&&f(a.Zg.zk,function(a){c.add(a)});else{var k=[],l=[],m=[],n=this.Rw(),p=[];e.isArray(a)? f(a,function(a){b(a)&&p.push(a.ma)}):b(a)&&(p=[a.ma]);if(k.length){var q=new g.Wb.kL({path:k,height:d?0:this.xX,color:l});q.transparent=!0;q.ZM=!0;q.qX=p;this.add(q);a.Zg=q;if(d){var r=[];f(k,function(a){var b=new g.Wb.Aw({width:g.l.Mc?8:4}),d=b.da;f(a,function(a){d.Y.push(a.x,a.y,0);d.Wa.push.apply(d.Wa,c.W1)});c.add(b);b.ZM=b.transparent=!0;r.push(b)});a.Zg.zk=r}else{var d=new g.Wb.Vo,s=d.da,u=0;d.transparent=!0;var v=s.pma=[];f(k,function(a,b){var d=u,e=4*(a.length-1);v[b]=[0!==b?v[b-1][1]:0,0!== b?v[b-1][1]+e:e];f(a,function(e,f){if(f!==a.length-1){var k=f===a.length-2;s.Y.push(e.x,e.y,-1*(c.xX+1));s.Wa.push.apply(s.Wa,m[b]);s.Kh.push(u,k?d:u+1);u++}})});a.Zg.lp=d;this.add(d)}}}},Dia:function(a){var b=a.da.kg;a.da.zf=[{wa:[[b[0],b[1]],[b[2],b[1]],[b[2],b[3]],[b[0],b[3]]]}]},XA:function(a){function b(){k.get("cursor")&&k.iG&&(k.oa.setDefaultCursor(k.iG),k.iG=void 0)}function c(){k.If.hide()}function d(b){var c=void 0,c="floor"===b.ql?k.Bb.I2(b.$n):b.name||b.name_cn;g.a.ja(["\\u8f85\\u52a9\\u9762"], c)||(k.If.Sca!==c&&(k.If.setContent(\'<div class="amap-indoor-map-moverf-marker">\'+c+"</div>"),k.If.Sca=c),k.If.setPosition(a.lnglat),k.If.show())}function e(){var a=k.Jn;if(a.fK){a.DD.B.color[a.index]=a.fillColor;a.DD.lr=!0;var b=a.DD.lp;if(b){for(var c=b.da,d=k.Jn.rn,e=d[0],d=d[1];e<d;e+=4){var f=[e,4].concat(k.Jn.strokeColor);c.Wa.splice.apply(c.Wa,f)}b.At=!0}a.fK=null;a.DD=null;a.rn=null;k.reDraw()}}function f(a,b,c){if(k.Jn.fK!==b.cpid){e();k.Jn.fK=b.cpid;k.Jn.fillColor=a.B.color[c];k.Jn.DD=a; k.Jn.index=c;a.B.color[c]=k.W_.fillColor;a.lr=!0;if(a.lp){b=a.lp.da;var d=b.pma[c];k.Jn.strokeColor=b.Wa.slice(d[0],d[0]+4);k.Jn.rn=d;c=d[0];for(d=d[1];c<d;c+=4){var f=[c,4].concat(k.W_.strokeColor);b.Wa.splice.apply(b.Wa,f)}a.lp.At=!0}k.reDraw()}}var h=this;this.oa.C=!0;if(!this.oa||17>this.oa.getZoom())this.oa.C=!1;else{this.oa.C=!1;var k=this,l=a.lnglat;if(!(l&&this.SA&&l.cb(this.SA))){this.oM&&clearTimeout(this.oM);this.oM=setTimeout(function(){var a=h.Rw();h.VG(a.mr);h.eA();h.oM=null},300);this.SA= l;this.oa.C=!0;var m=this.oa.getObject3DByContainerPos(a.tb||a.pixel,[this]);this.oa.C=!1;if(m)if((l=m.object)&&l.ZM&&"prism"===l.type){var n=null,n=l.qX,n=n.length?n[0].$n:n.$n;this.Pt({id:n});if(n=this.R2(l,m.index))if(m=n.E6,n=n.index,m)switch(m.ql){case "shops":f(l,m,n);d(m);k.get("cursor")&&void 0===k.iG&&(k.iG=k.oa.getDefaultCursor(),k.oa.setDefaultCursor(k.get("cursor")));break;case "floor":e();b();d(m);break;default:e(),b(),c()}}else e(),b(),c();else e(),b(),c()}}},R2:function(a,b){for(var c= a.qX,d=a.da.UH,e=0,f=d.length;e<f;e++)if(1===d[e][b])return{index:e,E6:c[e]};return null},FU:function(){var a=this;this.rqa=this.DM();this.Bb.Br.forEach(function(b){if(b.ha&&void 0!==b.Nc){var c=g.a.ja(a.rqa,b.id)?a.add:a.remove;b=b.ha[b.Nc];var d=b.Nl,e=b.ha;b=[];d.Zg&&(b=b.concat(d.Zg,d.Zg.zk));e.Zg&&(b=b.concat(e.Zg,e.Zg.lp));if(b.length)for(d=0,e=b.length;d<e;d++)b[d]&&c.call(a,b[d])}})},Mf:function(){var a=this;if(!this.tt)return null;setTimeout(function(){a.mapChanged()},0);var b=z.o.dt.Sc.Mf.apply(this, arguments);b.Zda=b.te;this.FU=g.a.$C(this.FU,300,this);b.te=function(){var a=this.U;a.oa.view.wo()||a.FU();return this.Zda()};return b}})); ')