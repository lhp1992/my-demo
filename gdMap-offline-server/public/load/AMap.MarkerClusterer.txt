_jsload_('AMap.MarkerClusterer', 'g.I9=g.aa.extend({r:function(a,b){this.CLASS_NAME="AMap.Cluster";this.wl=a;this.e=a.getMap();this.Hn=a.getGridSize()*b;this.ZA=a.getMinClusterSize();this.Fw=a.isAverageCenter();this.ax=a.ax;this.Vh=null;this.hb=[];this.Mb=this.marker=new z.w.rb({innerOverlay:!0});this.Mb.za=!0},H0:function(a){if(!this.Vh)this.Vh=a.tk;else if(this.Fw){var b=this.hb.length+1;this.Vh=new g.H((this.Vh.x*(b-1)+a.tk.x)/b,(this.Vh.y*(b-1)+a.tk.y)/b)}a.LI=!0;a.sP=this;this.hb.push(a)},Iua:function(a){-1!==this.hb.indexOf(a)&& (a.LI=!1,a.sP=null);return this.hb.length},Jm:function(){for(var a=[],b=[],c=0,d=this.hb.length;c<d;c+=1)this.hb[c].vG?a.push(this.hb[c]):b.push(this.hb[c]);this.e.remove(a);this.hb=b;d=b.length;d<this.ZA||this.e.getZoom()>this.ax?(this.e.add(this.hb),this.R6()):(this.e.remove(this.hb),this.Lxa())},remove:function(){this.e.remove(this.hb);this.R6();this.Mb.off("click",this.qJ,this);this.hb=this.Vh=this.e=this.wl=this.Mb=null},ki:function(){return this.Vh},$qa:function(a){return Math.abs(a.tk.x-this.Vh.x)<= this.Hn&&Math.abs(a.tk.y-this.Vh.y)<=this.Hn},Lxa:function(){this.wl.PJ?this.wl.PJ.call(null,{markers:this.hb,count:this.hb.length,marker:this.Mb}):this.PJ();this.Mb.setPosition(this.e.Mh(this.Vh,20));g.event.addListener(this.Mb,"click",this.qJ,this);this.Mb.setMap(this.e)},PJ:function(){var a=this.wl.getStyles().length,a=(0,this.wl.RL)(this.hb,a),a=this.Nta(a.text,this.wl.getStyles()[a.index-1]);this.Mb.setContent(a.content);this.Mb.setOffset(a.offset)},R6:function(){this.Mb.setMap(null)},Nta:function(a, b){var c=document.createElement("div");c.style.width=b.size.width+"px";c.style.height=b.size.height+"px";c.innerHTML=a;c.style.backgroundImage="url("+b.url+")";c.style.textAlign="center";c.style.lineHeight=b.size.height+"px";c.style.backgroundPosition=b.imageOffset?b.imageOffset.x+"px "+b.imageOffset.y+"px":"0 0";c.style.color=b.textColor||"#000";c.style.fontSize=b.textSize?b.textSize+"px":"12px";c.style.cursor="pointer";var d=b.offset||new g.H(0,0);return{content:c,offset:d}},disperse:function(){g.c.add(this, "disperse");if(this.e&&this.Mb){var a=this.e.U2(this.hb,0,new g.H(40,40)),b=this.e.getZoom();a[0]<=b&&(a[0]=b+1);this.e.setZoomAndCenter(a[0],a[1])}},qJ:function(){var a=this.wl.ZG;this.wl.q("click",{cluster:this,lnglat:this.Mb.getPosition(),target:this.wl,markers:this.hb,map:this.wl.e});a&&!this.wl.stopDisperse&&(this.wl.stopDisperse=void 0,this.disperse())}}); g.u$=g.aa.extend({ja:[g.sa],r:function(a,b,c){this.CLASS_NAME="AMap.MarkerClusterer";g.c.va(this,c);c=c||{};this.Hn=c.gridSize||60;this.ZA=c.minClusterSize||2;this.ax=c.maxZoom||18;this.Fw=!0;this.PJ=c.renderClusterMarker||c.renderCluserMarker||null;void 0!==c.averageCenter&&(this.Fw=c.averageCenter);this.ZG=!0;void 0!==c.zoomOnClick&&(this.ZG=c.zoomOnClick);if(c.styles)for(var d=0;d<c.styles.length;d+=1)c.styles[d].size=g.a.bq(c.styles[d].size);this.c0=c.styles||this.uda();this.e=null;this.hb=[]; this.sk=[];this.jG=[];this.setMap(a);b&&this.addMarkers(b)},addMarker:function(a){g.c.add(this,"addMarker");this.r_(a)&&this.wF()},addMarkers:function(a){this.e.p20ToLngLat(g.a.ac);g.c.add(this,"addMarkers");for(var b=!1,c=0,d=a.length;c<d;c+=1)this.r_(a[c])&&(b=!0);b&&this.wF()},removeMarker:function(a){g.c.add(this,"removeMarker");this.tG(a)&&(this.Jm(),a=g.a.indexOf(this.hb,a),-1!==a&&this.hb.splice(a,1))},removeMarkers:function(a){g.c.add(this,"removeMarkers");for(var b=!1,c=0,d=a.length;c<d;c+= 1)var e=this.tG(a[c]),b=b||e;if(b){this.Jm();a=[];for(c=0;c<this.hb.length;c+=1)this.hb[c].vG||a.push(this.hb[c]);this.hb=a}},clearMarkers:function(){g.c.add(this,"clearMarkers");this.jX();this.hb=[]},getClustersCount:function(){g.c.add(this,"getClustersCount");return this.sk.length},getMap:function(){g.c.add(this,"getMap");return this.e},setMap:function(a){g.c.add(this,"setMap");this.e!==a&&(this.jX(),this.$ja(),this.e=a,this.hba(),this.wF())},getMarkers:function(){g.c.add(this,"getMarkers");for(var a= [],b=0,c=this.hb.length;b<c;b+=1)a.push(this.hb[b]);return a},setMarkers:function(a){g.c.add(this,"setMarkers");this.clearMarkers();this.addMarkers(a)},getGridSize:function(){g.c.add(this,"getGridSize");return this.Hn},setGridSize:function(a){g.c.add(this,"setGridSize");this.Hn!==a&&(this.Hn=a,this.ar())},getMinClusterSize:function(){g.c.add(this,"getMinClusterSize");return this.ZA},setMinClusterSize:function(a){g.c.add(this,"setMinClusterSize");this.ZA!==a&&(this.ZA=a,this.ar())},getMaxZoom:function(){g.c.add(this, "getMaxZoom");return this.ax},setMaxZoom:function(a){g.c.add(this,"setMaxZoom");this.ax!==a&&(this.ax=a,this.ar())},isAverageCenter:function(){g.c.add(this,"isAverageCenter");return this.Fw},setAverageCenter:function(a){g.c.add(this,"setAverageCenter");this.Fw!==a&&(this.Fw=a,this.ar())},wDa:function(){return this.ZG},EFa:function(a){this.ZG=a},getStyles:function(){g.c.add(this,"getStyles");return this.c0},setStyles:function(a){g.c.add(this,"setStyles");this.c0=a;this.ar()},tCa:function(){return this.RL}, wFa:function(a){this.RL=a},Woa:function(a){if("3D"==this.e.view.type)return a;var b=this.e.hc(a.jy()),c=this.e.hc(a.Fu());a=c.x-2*this.Hn;c=c.y+2*this.Hn;b=this.e.Mh(new g.H(b.x+2*this.Hn,b.y-2*this.Hn));a=this.e.Mh(new g.H(a,c));return new g.me(a,b)},r_:function(a){if(a.aJ!==this)return a.LI=!1,a.vG=!1,a.aJ=this,a.getDraggable()&&(a.Iw=g.event.addListener(a,"dragend",this.ar,this)),this.hb.push(a),!0},Eua:function(a){a.remove()},tG:function(a){if(a&&a.aJ===this){a.vG=!0;a.Iw&&(g.event.removeListener(a.Iw), delete a.Iw);a.aJ=null;a.tk=null;var b=a.sP;b&&b.Iua(a);return!0}return!1},wF:function(){if(this.e){var a=this.e.get("zoom");if(a<<0===a||"3D"===this.e.view.type){for(var b=this.Woa(this.e.getBounds()),a=Math.pow(2,20-a),c=0,d=this.hb.length;c<d;c+=1){var e=this.hb[c];!e.LI&&b.contains(e.getPosition())&&this.Laa(e,a)}this.Jm()}}},Jm:function(){for(var a=[],b=[],c=0,d=this.sk.length;c<d;c+=1)this.sk[c].Jm(),this.sk[c].hb.length?b.push(this.sk[c]):a.push(this.sk[c]);this.sk=b;c=0;for(d=a.length;c<d;c+= 1)this.Eua(a[c])},jX:function(){var a,b;a=0;for(b=this.sk.length;a<b;a+=1)this.sk[a].remove();this.sk=[];a=0;for(b=this.hb.length;a<b;a+=1){var c=this.hb[a];c.LI=!1;c.sP=null;c.aJ=null;c.tk=null;delete c.vG;c.Iw&&(g.event.removeListener(c.Iw),c.Iw=null);this.hb[a].setMap(null)}},ar:function(){this.setMarkers(this.hb)},refresh:function(){for(var a=0,b=this.hb.length;a<b;a+=1)this.hb[a].tk=null;this.ar()},Laa:function(a,b){var c=null,d=Number.MAX_VALUE;a.tk||(a.tk=this.e.Ab(a.getPosition()));for(var e= 0,f=this.sk.length;e<f;e+=1){var h=this.sk[e],k=(h.Vh.x-a.tk.x)*(h.Vh.x-a.tk.x)+(h.Vh.y-a.tk.y)*(h.Vh.y-a.tk.y);k<=d&&(d=k,c=h)}c&&c.$qa(a)?c.H0(a):(c=new g.I9(this,b),c.H0(a),this.sk.push(c))},hba:function(){this.e&&(this.jG=this.jG.concat([g.event.addListener(this.e,"zoomend",this.ar,this),g.event.addListener(this.e,"moveend",this.wF,this)]))},$ja:function(){for(var a=this.jG.pop();a;)g.event.removeListener(a),a=this.jG.pop()},uda:function(){for(var a=[53,56,66,78,90],b=[],c=0;5>c;c+=1)b.push({url:g.A.yb+ "/theme/v1.3/m"+(c+1)+".png",size:new g.xd(a[c],a[c]),offset:new g.H(-a[c]/2,-a[c]/2,!0)});return b},RL:function(a,b){for(var c=0,d=a.length,e=d;0!==e;)e=parseInt(e/10,10),c+=1;c=Math.min(c,b);return{text:d,index:c}}});window.AMap.MarkerClusterer=g.u$; ')