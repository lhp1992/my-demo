_jsload_('AMap.RangingTool', 'g.AV=g.aa.extend({ja:[g.sa],xi:".amap-ranging-label{_width:10px;font-size:12px;line-height:14px;background:#fff;border:solid 1px #ccc;padding:3px 7px 3px 2px;white-space:nowrap}.amap-ranging-label span{height:12px;vertical-align:center;display:inline-block;white-space:nowrap;margin-left:5px}.amap-ranging-label span img{margin-top:-2px;_margin-bottom:3px;+margin-top:2px}.amap-ranging-label span .delimg{margin-bottom:-3px;_margin-bottom:0;+margin-top:-1px}",r:function(a,b){this.CLASS_NAME="AMap.RangingTool"; g.c.va(this,b);this.Vg={Lq:0,gt:1,aA:2};if(!a)throw"\\u521b\\u5efaAMap.RangingTool\\u5b9e\\u4f8b\\u5fc5\\u987b\\u4f20\\u5165\\u5730\\u56fe\\u5bf9\\u8c61\\u4f5c\\u4e3a\\u7b2c\\u4e00\\u4e2a\\u53c2\\u6570: new AMap.RangingTool(mapObj);";this.e=a;b=b||{};for(var c=g.A.yb+"/images/pldot.png",d=new g.xd(12,12),e=new g.H(6,6),f=[],h=new g.H(-6,6),k=0;3>k;k+=1)f.push({icon:new z.w.Th({size:d,imageOffset:new g.H(-12*k,0),image:c,anchor:e,innerOverlay:!0}),offset:new g.H(-6,-6),cursor:"pointer",bubble:!0,draggable:!1,zIndex:120, innerOverlay:!0});this.startMarkerOptions=f[0];this.midMarkerOptions=f[2];this.endMarkerOptions=f[1];this.lineOptions=this.tmpLineOptions={strokeColor:"#1791fc",strokeOpacity:0.8,strokeWeight:2,bubble:!0,draggable:!1,innerOverlay:!0};this.startLabelText="\\u8d77\\u70b9</div>";this.midLabelText="{d}\\u516c\\u91cc</div>";this.endLabelText="\\u5171{d}\\u516c\\u91cc</div>";this.startLabelOffset=this.midLabelOffset=this.endLabelOffset=h;this.Rx=1E3;1===b.d&&(this.Rx=1,this.midLabelText="{d}\\u7c73</div>",this.endLabelText= "\\u5171{d}\\u7c73</div>");this.qna="<img src=\'"+g.A.yb+"/images/remove.png\' />";this.pna="<img class=\'delimg\' src=\'"+g.A.yb+"/images/destroy.png\' />";this.Vf(this,b);this.Mn=null;this.ai=this.Vg.Lq},Db:function(a){this.Vf(this,a)},Vf:function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c],"tmpLineOptions"===c||"lineOptions"===c)&&(a[c].bubble=!0)},Oxa:function(a,b){var c={position:[void 0,"setPosition"],draggable:[!1,"setDraggable"],angle:[0,"setRotation"],content:[void 0,"setContent"],icon:[void 0, "setIcon"],offset:[void 0,"setOffset"],cursor:["default","setCursor"],zIndex:[100,"setzIndex"],opacity:[1,"setOpacity"]},d;for(d in c)if(c.hasOwnProperty(d)){var e=b[d]||c[d][0];if(void 0!==e)a[c[d][1]](e)}},turnOn:function(){g.c.add(this,"turnOn");this.ai===this.Vg.Lq&&(this.iZ(),this.JW=this.e.getStatus().doubleClickZoom,this.e.setStatus({doubleClickZoom:!1}));g.event.O(this,"turnon")},turnOff:function(a){g.c.add(this,"turnOff");this.ai===this.Vg.gt?(this.Lia(),this.e.setStatus({doubleClickZoom:this.JW})): this.ai===this.Vg.aA&&(this.Et(),this.A0(),this.e.setStatus({doubleClickZoom:this.JW}));a&&this.Via();g.event.O(this,"turnoff")},iZ:function(){this.e.g("click",this.JN,this,!0);this.ai=this.Vg.gt},Lia:function(){this.e.G("click",this.JN,this);this.ai=this.Vg.Lq},Mia:function(){this.e.g("click",this.kZ,this);this.e.g("mousemove",this.Yq,this);this.e.g("rightclick",this.Et,this,!0);this.e.g("dblclick",this.Et,this,!0);this.hfa=g.event.X(document,"keydown",this.mG,this);this.ai=this.Vg.aA},A0:function(){this.e.G("click", this.JN,this);this.e.G("click",this.kZ,this);this.e.G("mousemove",this.Yq,this);this.e.G("rightclick",this.Et,this);this.e.G("dblclick",this.Et,this,!0);g.event.removeListener(this.hfa);this.ai=this.Vg.Lq},jka:function(){this.A0();this.iZ();this.ai=this.Vg.gt},JN:function(a){this.e.set("allBubble",!0);var b={Fa:this.Mn},c={yl:a.lnglat};b.ep=c;this.Mn&&(this.Mn.next=b);this.mta=this.e.get("dragEnable");this.e.set("dragEnable",!1);this.Mn=b;this.nB(c,this.startMarkerOptions);this.nx(c,this.startLabelText, this.startLabelOffset,this.Sw(c,b));this.Mia();g.event.O(this,"addnode",{position:a.lnglat,marker:c.Mb})},kZ:function(a){var b=this.Mn,c=b.ep,d={yl:a.lnglat,Fa:c};c&&c.yl.cb(a.lnglat)?this.Et():(c.next=d,b.ep=d,this.nB(d,this.midMarkerOptions),this.nx(d,this.midLabelText,this.midLabelOffset,this.Sw(d,b)),this.C_(b),this.Mm&&this.Mm.setPath([a.lnglat,a.lnglat]),g.event.O(this,"addnode",{position:a.lnglat,marker:d.Mb}))},Yq:function(a){var b=this.Mn,c=b.ep.yl;this.Mm||(this.Mm=new z.w.Xb(this.tmpLineOptions), this.Mm.name="tmpLine",this.Mm.setMap(this.e));this.Mm.za=!0;this.Mm.setPath([c,a.lnglat]);c=this.Mm.getLength();b.Hf&&(c+=b.Hf.getLength());g.event.O(this,"move",{position:a.lnglat,distance:c,target:this})},mG:function(a){27===a.keyCode&&this.Et()},Et:function(){this.e.set("allBubble",!1);var a=this.Mn,b=a.ep;this.e.set("dragEnable",this.mta);this.endMarkerOptions.bubble=!1;b.Fa?(this.nB(b,this.endMarkerOptions),this.nx(b,this.endLabelText,this.endLabelOffset,this.Sw(b,a),this.XX(a))):this.uG(a); this.jka();this.Mm&&(this.Mm.setMap(null),this.Mm=null);a.Hf?(a.Hf.setOptions({bubble:!1}),g.event.O(this,"end",{polyline:a.Hf,points:a.Hf.getPath(),distance:a.Hf.getLength()})):g.event.O(this,"cancel")},C_:function(a){for(var b=[],c=a.ep;c;)b.unshift(c.yl),c=c.Fa;2>b.length?this.uG(a):a.Hf?a.Hf.setPath(b):(a.Hf=new z.w.Xb(this.lineOptions),a.Hf.za=!0,a.Hf.name="recrdLine",a.Hf.setPath(b),a.Hf.setMap(this.e));g.event.O(this,"update")},nB:function(a,b){var c=!a.Mb;this.Vf(b,{position:a.yl,innerOverlay:!0}); c?(a.Mb=new z.w.rb(b),a.Mb.name="marker",a.Mb.setMap(this.e),a.Mb.za=!0):(this.Oxa(a.Mb,b),g.event.vH(a.Mb));a.Mb.g("click",g.F.stopPropagation)},nx:function(a,b,c,d,e){var f=document.createElement("div"),h=0;a.Bm&&(a.Bm.setMap(null),delete a.Bm);if(b.match("{d}")){for(var k=a.Fa;k;)h+=k.yl.distance(k.next.yl),k=k.Fa;h=(h/this.Rx).toFixed(1===this.Rx?1:2);b=b.replace("{d}",h)}f.className="amap-ranging-label";h=document.createElement("span");h.innerHTML=b;f.appendChild(h);d&&f.appendChild(this.ZX(this.qna, d));e&&f.appendChild(this.ZX(this.pna,e));a.Bm=new z.w.rb({content:f,position:a.yl,offset:c,cursor:"pointer",zIndex:110,bubble:!0,innerOverlay:!0});a.Bm.za=!0;a.Mb.name="label";a.Bm.setMap(this.e)},bka:function(a){var b=a.ep;if(b){for(this.nx(b,this.endLabelText,this.endLabelOffset,this.Sw(b,a),this.XX(a));b.Fa;)b=b.Fa,this.nx(b,this.midLabelText,this.midLabelOffset,this.Sw(b,a));this.nx(b,this.startLabelText,this.startLabelOffset,this.Sw(b,a))}},ZX:function(a,b){var c=document.createElement("span"); c.innerHTML=a;g.F.g(c,"click",function(){b()});g.F.g(c,"mousedown",function(a){g.F.stopPropagation(a)});g.l.Z&&g.l.Cf&&(g.F.g(c,"touchstart",function(a){g.F.stopPropagation(a)}),g.F.g(c,"touchend",function(a){g.F.stopPropagation(a)}),g.F.g(c,"touchmove",function(a){g.F.stopPropagation(a)}));return c},Sw:function(a,b){var c=this;return function(d){c.ai!==c.Vg.aA&&c.mB(a,b);d&&g.F.stopPropagation(d)}},XX:function(a){var b=this;return function(c){b.ai!==b.Vg.aA&&b.uG(a);c&&g.F.stopPropagation(c)}},mB:function(a, b){a.Fa?a.Fa.next=a.next:a.next&&this.nB(a.next,this.startMarkerOptions);a.next?a.next.Fa=a.Fa:a.Fa&&(this.nB(a.Fa,this.endMarkerOptions),b.ep=a.Fa);a.Fa=a.next=null;a.Mb&&(a.Mb.setMap(null),a.Mb=null);a.Bm&&(a.Bm.setMap(null),a.Bm=null);this.C_(b);this.bka(b);g.event.O(this,"removenode",{polyline:b.Hf,points:b.Hf?b.Hf.getPath():[],distance:b.Hf?b.Hf.getLength():null,target:this})},uG:function(a){var b=a.ep;a.Hf&&(a.Hf.setMap(null),a.Hf=null);for(;b;)b.Mb&&(b.Mb.setMap(null),b.Mb=null),b.Bm&&(b.Bm.setMap(null), b.Bm=null),b=b.Fa;a.Fa&&(a.Fa.next=a.next);a.next?a.next.Fa=a.Fa:this.Mn=a.Fa;a.ep=a.Fa=a.next=null},Via:function(){for(;this.Mn;)this.uG(this.Mn)}});window.AMap.RangingTool=g.AV; ')