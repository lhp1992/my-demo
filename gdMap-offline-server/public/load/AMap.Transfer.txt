_jsload_('AMap.Transfer', 'g.$$={LEAST_TIME:0,LEAST_FEE:1,LEAST_TRANSFER:2,LEAST_WALK:3,MOST_COMFORT:4,NO_SUBWAY:5}; g.haa={BUS:"\\u666e\\u901a\\u516c\\u4ea4\\u7ebf\\u8def",SUBWAY:"\\u5730\\u94c1\\u7ebf\\u8def",METRO_RAIL:"\\u8f7b\\u8f68\\u7ebf\\u8def",TRAM:"\\u6709\\u8f68\\u7535\\u8f66",TROLLEYBUS:"\\u65e0\\u8f68\\u7535\\u8f66",TRAVEL_LINE:"\\u65c5\\u6e38\\u4e13\\u7ebf",AIRPORT_BUS:"\\u673a\\u573a\\u5927\\u5df4",COMMUNITY_CAR:"\\u793e\\u533a\\u4e13\\u8f66",MAGLEV_TRAIN:"\\u78c1\\u60ac\\u6d6e\\u5217\\u8f66\\u7ebf\\u8def",FERRY:"\\u8f6e\\u6e21",FUNICULAR:"\\u7d22\\u9053\\u4ea4\\u901a",OTHER:"\\u5176\\u4ed6\\u516c\\u4ea4\\u7ebf\\u8def"}; g.OV=g.aa.extend({ja:[g.sa],r:function(a){this.CLASS_NAME="AMap.Transfer";g.c.va(this,a);this.M=g.extend({outlineColor:"white",showDir:!0,isOutline:!0,autoFitView:!0},a);this.url=g.A.Rd+"/v3/direction/transit/integrated";(this.M.map||this.M.panel)&&g.qb.load("AMap.TransferRender")},clear:function(){g.c.add(this,"clear");this.N&&this.N.clear()},search:function(){g.c.add(this,"search");var a=arguments;if(0<a.length){var b=a[1];a[0]=g.a.Ha(a[0]);a[1]=g.a.Ha(a[1]);if(a[0].Q&&a[0].P)this.dk.apply(this, a);else if(a[0]instanceof Array){var c=this;2>a[0].length&&b&&"function"===typeof b&&b("error",{info:"short_of_params"});g.qb.Lg(["AMap.PlaceSearch","AMap.GetLL"],function(){c.Bh||(c.Bh=new g.Tz);var d=c.fa(c.M.city),e=d||a[0][0].city,f=c.fa(c.M.cityd)||d||a[0][1].city;a[0][0].city=e;a[0][1].city=f;c.Bh.get(a[0],d,function(d,k){"error"===d?b&&"function"===typeof b&&b("error",k):"complete"===d?c.dk(k[0].exit_location||k[0].location,k[1].entr_location||k[1].location,a[1]||void 0,k,[e,f]):"no_poi"=== d?a[1]&&a[1]("error",{info:"\\u5728\\u57ce\\u5e02"+k.city+"\\u65e0\\u6cd5\\u627e\\u5230"+k.keyword}):"no_city"===d&&a[1]&&a[1]("error",{info:"\\u8bf7\\u8bbe\\u7f6e"+k.keyword+"\\u7684\\u57ce\\u5e02\\u4fe1\\u606f"})})})}}},leaveAt:function(a,b){g.c.add(this,"leaveAt");this.T4=b||"";this.U4=a||""},dk:function(a,b,c,d,e){if(a instanceof g.T&&b instanceof g.T){var f,h;e&&(f=e[0],h=e[1]);this.fa(this.M.city)||f||!c||"function"!==typeof c?(a=["origin="+a.toString(),"destination="+b.toString(),"city="+(this.fa(this.M.city)|| f),"strategy="+this.fa(this.M.policy),"nightflag="+this.fa(this.M.nightflag?"1":"0"),"extensions="+this.fa(this.M.extensions),"s=rsv3"],this.T4&&a.push("date="+this.fa(this.T4)),this.U4&&a.push("time="+this.fa(this.U4)),(h=this.fa(this.M.cityd)||h)&&a.push("cityd="+h),a.push("key="+g.A.key),h=this.url+(0<a.length?"?"+a.join("&"):""),h=new g.fb.vb(h,{callback:"callback"}),h.g("complete",function(a){this.Fc(a,c,d)},this),h.g("error",function(a){this.ec(a,c)},this)):c("error","NO_CITY")}else c&&"function"=== typeof c&&c("error","NO_PARAMS")},setPolicy:function(a){g.c.add(this,"setPolicy");this.M.policy=a},setCity:function(a){g.c.add(this,"setCity");this.M.city=a},setCityd:function(a){g.c.add(this,"setCityd");this.M.cityd=a},ec:function(a,b){z.event.O(this,"error",a);b&&"function"===typeof b&&b("error",a.info)},Wha:function(a){for(var b=[],c=0;c<a.length;c+=1){var d=a[c];this.KG=this.XG=this.sG=this.QG=0;this.$q=[];d={cost:parseInt(d.cost,10)||0,time:this.Jb(d.duration),nightLine:"1"===d.nightflag,segments:this.bia(d.segments)}; d.transit_distance=this.QG;d.railway_distance=this.sG;d.walking_distance=this.XG;d.taxi_distance=this.KG;d.distance=this.QG+this.sG+this.XG+this.KG;d.path=this.$q;b[c]=d}return b},lia:function(a){var b=a.destination.split(","),c=a.origin.split(","),d=this.mia(a.steps),e=parseInt(this.fa(a.distance),10);this.XG+=e;for(var f=[],h=0;h<d.length;h+=1)f=f.concat(d[h].path);this.$q=this.$q.concat(f);return{time:this.Jb(a.duration),instruction:"\\u6b65\\u884c"+e+"\\u7c73"+d[d.length-1].assist_action,transit_mode:"WALK", distance:e,transit:{origin:new g.T(c[0],c[1]),destination:new g.T(b[0],b[1]),path:f,steps:d}}},mia:function(a){var b=[];a.step&&(a=[a.step]);for(var c=0;c<a.length;c+=1){var d=a[c],e=this.hp(d.polyline);b[c]={instruction:this.fa(d.instruction),road:this.fa(d.road),distance:this.Jb(d.distance,10),time:this.Jb(d.duration),path:e,action:this.fa(d.action),assist_action:this.fa(d.assistant_action)}}return b},Bd:function(a,b){var c=a.split(b||",");return new g.T(c[0],c[1])},hp:function(a){var b=[];a=a.split(";"); for(var c=0;c<a.length;c+=1)b[c]=this.Bd(a[c]);return b},iia:function(a){var b=a.buslines;if(0!==b.length){var c=b[0];a=c.departure_stop;a.location=this.Bd(a.location);c=c.arrival_stop;c.location=this.Bd(c.location);var d=this.jia(b),b=d[0];this.QG+=b.distance;this.$q=this.$q.concat(b.path);for(var e=[],f=0;f<d.length;f+=1)e.push({name:d[f].name,id:d[f].id,type:d[f].type,stime:d[f].stime,etime:d[f].etime});a={on_station:a,off_station:c,path:b.path,via_num:b.via_num,via_stops:b.via_stops,lines:e}; return{instruction:"\\u4e58\\u5750"+b.name+"\\u9014\\u5f84"+a.via_num+"\\u7ad9\\u5230\\u8fbe"+a.off_station.name,transit_mode:"\\u5730\\u94c1\\u7ebf\\u8def"===b.type?"SUBWAY":"\\u8f7b\\u8f68\\u7ebf\\u8def"===b.type?"METRO_RAIL":"BUS",time:b.time,transit:a,distance:b.distance}}},jia:function(a){for(var b=[],c=0;c<a.length;c+=1){var d=a[c],d={name:d.name,id:d.id,type:d.type,distance:this.Jb(d.distance),time:this.Jb(d.duration),path:this.hp(d.polyline),stime:d.start_time,etime:d.end_time,via_num:this.Jb(d.via_num), via_stops:this.gia(d.via_stops)};b[c]=d}return b},gia:function(a){for(var b=[],c=0;c<a.length;c+=1)b[c]={name:a[c].name,id:a[c].id,location:this.Bd(a[c].location)};return b},hia:function(a){var b={},c={};b.transit_mode="TAXI";b.instruction="";c.time=b.time=this.Jb(a.duration);c.distance=b.distance=this.Jb(a.distance)||0;c.origin=this.Bd(a.origin);c.destination=this.Bd(a.destination);c.sname=this.fa(a.sname);c.sname&&(b.instruction+="\\u4ece"+c.sname);this.KG+=b.distance;c.tname=this.fa(a.tname);b.transit= c;b.instruction+="\\u4e58\\u5750\\u51fa\\u79df\\u8f66\\u5230\\u8fbe";c.tname&&(b.instruction+=c.tname);return b},bia:function(a){a.segment&&(a=[a.segment]);for(var b=[],c=0;c<a.length;c+=1){var d=a[c];if(d.walking.origin){var e=this.lia(d.walking);b.push(e)}d.taxi&&d.taxi.destination&&(e=this.hia(d.taxi),b.push(e));if(d.bus&&d.bus.buslines.length){e=this.iia(d.bus);if(d.entrance.name&&e){var f=d.entrance.location.split(",");e.transit.entrance={name:d.entrance.name,location:new g.T(f[0],f[1])}}d.exit.name&& e&&(f=d.exit.location.split(","),e.transit.exit={name:d.exit.name,location:new g.T(f[0],f[1])});e&&b.push(e)}d.railway&&d.railway.name&&(d=this.Yha(d.railway),b.push(d))}return b},SN:function(a,b){delete a.start;delete a.end;a.location=this.Bd(a.location,b||" ");a.time=this.Jb(a.time);return a},kia:function(a){if(!a)return[];for(var b=0;b<a.length;b+=1)a[b]=this.SN(a[b],","),a[b].wait=this.Jb(a[b].wait);return a},dia:function(a){for(var b=0;b<a.length;b+=1)a[b].type=a[b].code,delete a[b].code,a[b].cost= this.Jb(a[b].cost);return a},Yha:function(a){var b={},c={};b.id=a.id;b.name=a.name;b.trip=a.trip;c.instruction="\\u4e58\\u5750"+b.trip;b.type=a.type;b.distance=this.Jb(a.distance);this.sG+=b.distance;b.time=this.Jb(a.time);b.departure_stop=this.SN(a.departure_stop);b.arrival_stop=this.SN(a.arrival_stop);a.via_stops&&(b.via_stops=this.kia(a.via_stops),b.via_num=b.via_stops.length,c.instruction+=",\\u9014\\u5f84"+b.via_num+"\\u7ad9",b.alters=a.alters||[]);b.spaces=this.dia(a.spaces);c.transit_mode="RAILWAY"; c.time=b.time;c.distance=b.distance;c.transit=b;c.instruction+="\\u5230"+b.arrival_stop.name;return c},fa:function(a){return"object"===typeof a||"undefined"===typeof a?"":a},Jb:function(a){a=parseInt(a,10);return isNaN(a)?0:a},close:function(){g.c.add(this,"close");this.closed=!0},open:function(){g.c.add(this,"open");this.closed=!1},searchOnAMAP:function(a){g.c.add(this,"searchOnAMAP");var b={t:1};b.m=this.M.policy;var c=g.a.Ha(a.origin),d=g.a.Ha(a.destination);b.sy=c.P;b.sx=c.Q;b.sname=a.originName|| "";b.dy=d.P;b.dx=d.Q;b.dname=a.destinationName||"";g.Qh.Ks(g.Qh.VQ(b))},Fc:function(a,b,c){if(!this.closed){var d={},e=this;if(parseInt(a.status,10)){if(a.count&&0===parseInt(a.count,10))d.info="ok"===a.info.toLowerCase()?"NO_DATA":a.info;else if(a.route){var f=a.route.origin.split(","),h=a.route.destination.split(","),k=this.Wha(a.route.transits),d={info:a.info,origin:new g.T(f[0],f[1]),destination:new g.T(h[0],h[1]),taxi_cost:parseInt(a.route.taxi_cost,10),plans:k};c&&(d.start=c[0],d.end=c[1],d.originName= d.start.name,d.destinationName=d.end.name)}b&&"function"===typeof b&&(d.plans&&0===d.plans.length?b("no_data",{}):b("complete",d));e.M.map||e.M.panel?g.qb.load("AMap.TransferRender",function(){e.N||(e.N=new window.AMap.TransferRender({showDir:e.M.showDir}));e.N.autoRender({data:d,panel:e.M.panel,map:e.M.map,hideMarkers:e.M.hideMarkers||!1,isOutline:e.M.isOutline,outlineColor:e.M.outlineColor,autoFitView:e.M.autoFitView},e);g.event.O(e,"complete",d)}):g.event.O(this,"complete",d)}else g.event.O(this, "error",{info:a.info}),b&&"function"===typeof b&&b("error",a.info)}}});window.AMap.Transfer=g.OV;window.AMap.TransferPolicy=g.$$;window.AMap.VehicleType=g.haa; ')