_cssload_('AMap.BezierCurveEditor', '.amap-bzcv-node{cursor:pointer;width:15px;height:15px}.amap-bzcv-node.amap-bzcv-middNode,.amap-bzcv-node.amap-bzcv-pathNode{background:url(http://localhost:8888/images/dd-via.png) 50% 50% no-repeat}.amap-bzcv-node.amap-bzcv-ctrlNode{background:url(http://localhost:8888/images/point.png) 50% 50% no-repeat}.amap-bzcv-node.amap-bzcv-mobile{width:25px;height:25px;background-color:rgba(0,0,0,.2);border-radius:13px}')
_jsload_('AMap.BezierCurveEditor', '(function(a){var b=a.aa.extend({ja:[a.sa],r:function(b,d,e,f){this.Pb=a.extend({getMarkerOptions:function(b){return{content:\'<div class="\'+(a.l.Z?"amap-bzcv-mobile ":"")+"amap-bzcv-node amap-bzcv-"+b+\'"></div>\',offset:a.l.Z?new a.H(-13,-13):new a.H(-8,-8)}},getCtrlLineOptions:function(){return{lineCap:"round",strokeDasharray:[10,10],strokeColor:"red",strokeOpacity:0.5,strokeWeight:3,strokeStyle:"dashed"}}},f);this.e=b;this.Jd=e;d&&this.xv(d)},xv:function(a){this.TW();this.oca(a)},pI:function(){if(!this.Jf)return[]; for(var a=[],b=0,e=this.Jf.length;b<e;b++)a.push(this.Oda(this.Jf[b]));return a},MJ:function(){this.xv(this.pI())},Oda:function(a){var b=a.getPosition();if(a.Ej){for(var e=[],f=0,h=a.Ej.length;f<h;f++)e.push(a.Ej[f].getPosition());b.controlPoints=e.length?e:null}return b},oca:function(a){this.Jf=[];for(var b=0,e=a.length;b<e;b++)this.nca(b,a[b])},TW:function(){if(this.Jf){for(var a=0,b=this.Jf.length;a<b;a++)this.Hw(this.Jf[a]);this.Jf=null}},Zia:function(a){if(this.Jf&&!(2>=this.Jf.length))for(var b= this.Jf,e=0,f=b.length;e<f;e++)if(b[e]===a)return b.splice(e,1),this.Hw(a),this.MJ(),this.q("_pathChanged"),!0},Hw:function(a){a.q("_clearNode");a.setMap(null);a.hi();var b,e;if(a.Ej){b=0;for(e=a.Ej.length;b<e;b++)this.Hw(a.Ej[b]);a.Ej=null}if(a.zt){b=0;for(e=a.zt.length;b<e;b++)this.Hw(a.zt[b]);a.zt=null}a.jF&&(a.jF.stop(),a.jF=null)},Yba:function(a){this.Hw(a)},nca:function(a,b){function e(a){this.q("addCtrlNode",a);this.Iaa(f)}var f=this.Xh("pathNode",{position:b});f.kG=a;f.rAa=!0;this.Jf[a]=f; f.g("dragstart",this.yga,this);f.g("click",function(a){this.Zia(f)&&this.q("removePathNode",a)},this);f.g("rightclick",e,this);f.g("longpress",e,this);0<a&&(b.controlPoints?this.hca(a,f):this.lca(a,f))},Iaa:function(a){a.Ej||(a.Ej=[]);var b=this.Jf[a.kG-1];if(b){var e=a.Ej.length;if(0===e)b=this.JM(b,a,0.5);else if(1===e)b=this.Kda(b.getPosition(),a.Ej[0].getPosition(),a.getPosition());else return;this.ZW(e,e+1,b,a.kG,function(){this.MJ();this.q("_pathChanged")})}},Kda:function(a,b,e){var f=this.e; a=f.hc(a);b=f.hc(b);e=f.hc(e);return f.Mh(e.add(a.$a(b)))},Xia:function(a){var b=this.Jf[a.qca];if(b&&b.Ej)for(var b=b.Ej,e=0,f=b.length;e<f;e++){if(b[e]===a){b.splice(e,1);this.Hw(a);this.MJ();this.q("_pathChanged");break}}else console.warn("ctrlNode owner missing!!!")},lca:function(a,b){var e=this.Jf[a-1];e&&(e=this.JM(e,b,0.5),e=this.Xh("middNode",{position:e,opacity:0.5}),e.aN=!0,e.Lfa=a,e.g("dragstart",this.wga,this),e.g("click",function(a){this.IN(a);this.HN(a)},this),b.zt=[e])},JM:function(a, b,e){return this.RX(a.getPosition(),b.getPosition(),e)},RX:function(a,b,e){var f=this.e;a=f.hc(a);b=f.hc(b);return f.Mh(a.add(b.$a(a).Gd(e)))},wga:function(a){a=a.target;a.Pd=!0;a.g("dragging",this.IN,this);a.g("dragend",this.HN,this)},IN:function(a){a=a.target;a.aN&&this.bca(a);a.q("_posChanged");this.q("_pathChanged")},bca:function(b){if(b.aN){var d=b.Lfa,e=this.Jf[d];this.Jf.splice(d,0,b);b.aN=!1;a.a.Tx(e.zt,b)}else console.warn("No middnode!")},HN:function(a){var b=a.target;b.Pd=!1;b.G("dragging", this.IN,this);b.G("dragend",this.HN,this);b.q("_posChanged");this.q("addPathNode",a);this.MJ();this.q("_pathChanged")},hca:function(a,b){var e=b.getPosition().controlPoints;if(e){b.Ej=[];for(var f=0,h=e.length;f<h;f++)this.ZW(f,h,e[f],a)}},yga:function(a){a=a.target;a.Pd=!0;a.g("dragging",this.RZ,this);a.g("dragend",this.QZ,this)},RZ:function(a){a=a.target;this.u_(a);a.q("_posChanged");this.q("_pathChanged")},QZ:function(a){var b=a.target;b.Pd=!1;this.u_(b);b.G("dragging",this.RZ,this);b.G("dragend", this.QZ,this);b.q("_posChanged");this.q("pathNodeDragEnd",a);this.q("_pathChanged")},u_:function(a){a=[a,this.Jf[a.kG+1]];for(var b=0,e=a.length;b<e;b++)this.Ria(a[b])},Ria:function(a){if(a&&a.zt){var b=this.Jf[a.kG-1];b&&a.zt[0].setPosition(this.JM(b,a,0.5))}},ZW:function(a,b,e,f,h){var k=this.Jf[f],l=[];0===a&&this.Jf[f-1]&&l.push(this.Jf[f-1]);a===b-1&&l.push(k);var m=this.Xh("ctrlNode",{position:e});m.uAa=l;m.mAa=!0;m.qca=f;m.g("dragstart",this.kga,this);m.g("click",function(a){this.q("removeCtrlNode", a);this.Xia(m)},this);if(l)for(b=0,e=l.length;b<e;b++)this.gca(m,l[b],h);return k.Ej[a]=m},Xh:function(b,d){var e=new z.w.rb(a.extend({map:this.e,position:null,draggable:!0,zIndex:this.Jd.get("zIndex")+1E3,innerOverlay:!0},this.Pb.getMarkerOptions(b),d));e.za=!0;return e},gca:function(b,d,e){function f(){h.setPath([b.getPosition(),d.getPosition()])}var h=new z.w.Xb(a.extend({map:this.e,innerOverlay:!0},this.Pb.getCtrlLineOptions()));h.za=!0;e?this.Raa(h,b,d,e):f();e=[b,d];for(var k=0,l=e.length;k< l;k++)e[k].g("_posChanged",function(){f()},this),e[k].g("_clearNode",function(){this.Yba(h)},this)},Raa:function(b,d,e,f){var h=d.getPosition(),k=e.getPosition(),l=new a.vj(0,1,function(a,b,c){return c/300},0.1);l.$p=function(a){1<=a&&(a=1);d.setPosition(this.RX(k,h,a));b.setPath([d.getPosition(),e.getPosition()]);1<=a&&(l.stop(),d.jF=null,f.call(this))};l.sn(this);d.jF=l},kga:function(a){a=a.target;a.Pd=!0;a.g("dragging",this.oZ,this);a.g("dragend",this.nZ,this)},oZ:function(a){a.target.q("_posChanged"); this.q("_pathChanged")},nZ:function(a){var b=a.target;b.Pd=!1;b.G("dragging",this.oZ,this);b.G("dragend",this.nZ,this);b.q("_posChanged");this.q("ctrlNodeDragEnd",a);this.q("_pathChanged")},Lj:function(){this.TW();this.hi()}});a.B9=a.aa.extend({ja:[a.sa],r:function(b,d,e){this.CLASS_NAME="AMap.BezierCurveEditor";a.c.va(this,e);this.Pb=a.extend({},e);this.e=b;this.Jd=d;this.yb=a.A.yb},Q1:function(){this.gT();var c=this.Jd.getPath();this.Nn=new b(this.e,c,this.Jd,this.Pb);this.Nn.g("_pathChanged",function(){this.Jd.setPath(this.Nn.pI(), !0)},this);this.Nn.g("removePathNode",function(b){a.event.O(this,"removenode",a.extend({},b,{target:this.Jd,type:"removenode"}))},this);this.Nn.g("addPathNode",function(b){a.event.O(this,"addnode",a.extend({},b,{target:this.Jd,type:"addnode"}))},this);this.Nn.g("removeCtrlNode",function(b){a.event.O(this,"removeCtrlNode",a.extend({},b,{target:this.Jd,type:"removeCtrlNode"}))},this);this.Nn.g("addCtrlNode",function(b){a.event.O(this,"addCtrlNode",a.extend({},b,{target:this.Jd,type:"addCtrlNode"}))}, this);this.Nn.g("pathNodeDragEnd",function(b){a.event.O(this,"adjust",a.extend({},b,{target:this.Jd,type:"adjust"}))},this);this.Nn.g("ctrlNodeDragEnd",function(b){a.event.O(this,"adjust",a.extend({},b,{target:this.Jd,type:"adjust"}))},this)},gT:function(){this.Nn&&this.Nn.Lj()},open:function(){a.c.add(this,"open");this.Q1();this.Jd.g("setPath",this.f_,this)},f_:function(){this.gT();this.Q1()},close:function(){a.c.add(this,"close");this.gT();this.Jd.G("setPath",this.f_,this);a.event.O(this,"end", {type:"end",target:this.Jd})}})})(g);window.AMap.BezierCurveEditor=g.B9; ')